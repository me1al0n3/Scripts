local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Mouse = game.Players.LocalPlayer:GetMouse()
local CamlockState = false
local Prediction = 0.15634

function FindNearestEnemy()
    local ClosestDistance, ClosestPlayer = math.huge, nil;
    for _, Player in next, game:GetService("Players"):GetPlayers() do
        if Player ~= LocalPlayer then
            local Character = Player.Character
            if Character and Character.Humanoid.Health > 1 then 
                local Position, IsVisibleOnViewPort = game:GetService("Workspace").CurrentCamera:WorldToViewportPoint(Character.HumanoidRootPart.Position)
                if IsVisibleOnViewPort then
                    local Distance = (Vector2.new(Mouse.X, Mouse.Y) - Vector2.new(Position.X, Position.Y)).Magnitude
                    if Distance < ClosestDistance then
                        ClosestPlayer = Player.Character.HumanoidRootPart
                        ClosestDistance = Distance
                    end
                end
            end
        end
    end
    return ClosestPlayer, ClosestDistance
end

local function CheckWall(part, direction, distance)
    local ray = Ray.new(part.Position, direction.unit * distance)
    local hit, position = game.Workspace:FindPartOnRay(ray, LocalPlayer.Character, false, true)
    if hit then
        return position
    end
    return nil
end

local enemy = nil
-- Function to aim the camera at the nearest enemy's HumanoidRootPart
RunService.Heartbeat:Connect(function()
    if CamlockState == true then
        if enemy then
            local camera = workspace.CurrentCamera
            local enemyPosition = enemy.Position + enemy.Velocity * Prediction
            local direction = (enemyPosition - camera.CFrame.p).unit
            local distance = (enemyPosition - camera.CFrame.p).magnitude
            local wallPosition = CheckWall(camera.CFrame.p, direction, distance)
            if not wallPosition then
                camera.CFrame = CFrame.new(camera.CFrame.p, enemyPosition)
            end
        end
    end
end)

local gui = Instance.new("ScreenGui")
gui.Name = "patrickGui"
gui.Parent = game.CoreGui

local TextButton = Instance.new("TextButton")
TextButton.Text = "Toggle CamLock"
TextButton.TextSize = 24
TextButton.TextColor3 = Color3.new(1, 1, 1)
TextButton.BackgroundColor3 = Color3.new(0, 0, 0)
TextButton.BorderColor3 = Color3.new(1, 1, 1)
TextButton.BorderSizePixel = 4
TextButton.Font = Enum.Font.Code
TextButton.Size = UDim2.new(0.2, 0, 0.2, 0)
TextButton.Position = UDim2.new(0, 0, 0.5, 0)
local state = true
TextButton.MouseButton1Click:Connect (function()
    state = not state
    if not state then
        TextButton.Text = "Al0n3 Lock ON"
        CamlockState = true
        enemy = FindNearestEnemy()
    else
        TextButton.Text = "Al0n3 Lock OFF"
        CamlockState = false
        enemy = nil
    end
end)
TextButton.Parent = gui
TextButton.Draggable = true

local cornerUI = Instance.new("UICorner")
cornerUI.CornerRadius = UDim.new(0, 5)
cornerUI.Parent = TextButton

local uiStroke = Instance.new("UIStroke")
uiStroke.Color = Color3.new(0, 0, 0)
uiStroke.Thickness = 200
uiStroke.Parent = TextButton
